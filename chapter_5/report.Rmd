---
title: "Replication and extension report"
author: "Andrew Heiss"
date: "November 24, 2015"
output: 
  html_document: 
    css: fixes.css
    highlight: pygments
    includes:
      in_header: scripts.html
    number_sections: yes
    self_contained: no
    theme: flatly
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=TRUE, cache=TRUE)
source("replicate_models.R")
library(stargazer)
library(ggplot2)
library(scales)
library(gridExtra)
```

# Replication results

Before merging in the new funding, engagement, and NGO data, I wanted to ensure that the models from the original AJPS article were correct and that they replicated in R instead of just Stata. Beyond some minor issues (discussed in the next section) and some slight differences in R and Stata's robust standard errors algorithms, the AJPS article is 100% reproducible. 

## AJPS table 1

```{r, results='asis', echo=FALSE}
var.labs <- c("Total population (logged)", "Missing information", 
              "NGO density", "Worse civil liberties", 
              "Regional density of criminalization", 
              "2000 TIP protocol ratification",
              "Trafficking intensity in countries of origin", 
              "Trafficking intensity in transit countries", 
              "Trafficking intensity in destination countries")
col.labs <- c("Model 1.1", "Model 1.2", "Model 1.3")

ses <- list(sqrt(diag(model1.1$var)), sqrt(diag(model1.2$var)),
            sqrt(diag(model1.3$var)))

extra.lines <- list(c("Number of countries", 
                      c(model1.1.fit["n.max"], model1.2.fit["n.max"],
                        model1.3.fit["n.max"])),
                    c("Number of inclusions", 
                      c(model1.1.fit["events"], model1.2.fit["events"],
                        model1.3.fit["events"])))

stargazer(model1.1, model1.2, model1.3, 
          apply.coef=exp, covariate.labels=var.labs, column.labels=col.labs, 
          keep.stat=c("n", "ll"), model.numbers=FALSE, dep.var.labels.include=FALSE,
          dep.var.caption="Time to Inclusion in Report", 
          se=ses, p.auto=FALSE, type="html",
          notes.align="l", add.lines=extra.lines,
          notes=c("Robust standard errors in parentheses; values differ from published article because of differences in the robustness algorithms Stata and R use. All explanatory variables are lagged one period unless otherwise noted."))
```

## AJPS table 2

```{r, results='asis', echo=FALSE}
var.labs <- c("Worse civil liberties", "US aid (logged)", "GDP (logged)", 
              "Total population (logged)", "2000 TIP protocol ratification", 
              "NGO density", "Corruption", "Rule of law", "Constant")
col.labs <- c("Model 2.1", "Model 2.2")

extra.lines <- list(c("Pseudo R-squared",
                      sapply(list(model2.1, model2.2), 
                             calc.pseudo.r.squared)))
stargazer(model2.1, model2.2, 
          apply.coef=exp, covariate.labels=var.labs, column.labels=col.labs, 
          model.numbers=FALSE, dep.var.labels.include=FALSE,
          dep.var.caption="US Pressure", type="html",
          keep.stat=c("n", "ll"), 
          notes.align="l", add.lines=extra.lines,
          notes=c("Logit model; odds ratios reported. Non-robust standard errors in parentheses. All explanatory variables are lagged one period."))
```

## AJPS table 3

```{r, results='asis', echo=FALSE}
var.labs <- c("In report", "Share of women in parliament", "Worse civil liberties",
              "Regional density of criminalization", "2000 TIP protocol ratification",
              "Missing information (t−2)", 
              "Trafficking intensity in countries of origin", 
              "Trafficking intensity in transit countries", 
              "Trafficking intensity in destination countries",
              "Total population (logged)",
              "NGO density", "GDP per capita (logged)", "Corruption", 
              "US aid (logged)", "US aid × In report",
              "US aid as share of GDP", "US aid as share of GDP × In report")
col.labs <- c("Model 3.1", "Model 3.2", "Model 3.3", "Model 3.4", "Model 3.5")

ses <- list(sqrt(diag(model3.1$var)), sqrt(diag(model3.2$var)), 
            sqrt(diag(model3.3$var)), sqrt(diag(model3.4$var)),
            sqrt(diag(model3.5$var)))

extra.lines <- list(c("Number of countries", 
                      c(model3.1.fit["n.max"], model3.2.fit["n.max"],
                        model3.3.fit["n.max"], model3.4.fit["n.max"],
                        model3.5.fit["n.max"])),
                    c("Number of criminalizations", 
                      c(model3.1.fit["events"], model3.2.fit["events"],
                        model3.3.fit["events"], model3.4.fit["events"],
                        model3.5.fit["events"])))

stargazer(model3.1, model3.2, model3.3, model3.4, model3.5, 
          apply.coef=exp, covariate.labels=var.labs, column.labels=col.labs, 
          keep.stat=c("n", "ll"), model.numbers=FALSE, dep.var.labels.include=FALSE,
          dep.var.caption="Time to Criminalization", 
          se=ses, p.auto=FALSE, type="html",
          notes.align="l", add.lines=extra.lines,
          notes=c("Robust standard errors in parentheses; values differ from published article because of differences in the robustness algorithms Stata and R use. All explanatory variables are lagged one period unless otherwise noted."))
```

## AJPS table 4

```{r, results='asis', echo=FALSE}
var.labs <- c("Tier 1", "Tier 2", "Watch list", "Tier 3", "In report", 
              "First demotion (t−3)", "First demotion (t−2)", 
              "First demotion (t−1)", "Share of women in parliament", 
              "Worse civil liberties", "Regional density of criminalization", 
              "2000 TIP protocol ratification", "Missing information",
              "Trafficking intensity in countries of origin", 
              "Trafficking intensity in transit countries", 
              "Trafficking intensity in destination countries",
              "Total population (logged)", "NGO density", "US aid (logged)", 
              "GDP per capita (logged)", "Corruption")
col.labs <- c("Model 4.1", "Model 4.2", "Model 4.3", "Model 4.4")

ses <- list(sqrt(diag(model4.1$var)), sqrt(diag(model4.2$var)),
            sqrt(diag(model4.3$var)), sqrt(diag(model4.2$var)))

extra.lines <- list(c("Number of countries", 
                      c(model4.1.fit["n.max"], model4.2.fit["n.max"]),
                      c(model4.3.fit["n.max"], model4.4.fit["n.max"])),
                    c("Number of criminalizations", 
                      c(model4.1.fit["events"], model4.2.fit["events"]),
                      c(model4.3.fit["events"], model4.4.fit["events"])))

stargazer(model4.1, model4.2, model4.3, model4.4 ,
          apply.coef=exp, covariate.labels=var.labs, column.labels=col.labs, 
          keep.stat=c("n", "ll"), model.numbers=FALSE, dep.var.labels.include=FALSE,
          dep.var.caption="Time to Criminalization", 
          se=ses, p.auto=FALSE, type="html",
          notes.align="l", add.lines=extra.lines,
          notes=c("Robust standard errors in parentheses; values differ from published article because of differences in the robustness algorithms Stata and R use. All explanatory variables are lagged one period unless otherwise noted."))
```

## Chapter 5 table A5.1

The current draft of the chapter uses descriptive statistics to show that countries with documented reactions to the TIP report are more likely to follow up with legislative action in the following year. This conclusion is borne out with multivariate statistical analysis. As seen in the models below, countries with a recorded non-media reaction are 77–88% more likely to criminalize human trafficking (model 5.1: `r I(parens(model5.1, "L.reactionnomedia", "z"))`; model 5.2: `r I(parens(model5.2, "L.reactionnomedia", "z"))`). The intensity of reactions to the report also has an effect—for every additional type of reaction, countries are approximately 20% more likely to criminalize trafficking (`r I(parens(model5.3, "L.totalreactionnomedia", "z"))`).

These results differ slightly from what is currently in the chapter draft because the models use cleaner and ostensibly more accurate data (the same data used for replicating the AJPS models). 

```{r, results='asis', echo=FALSE}
var.labs <- c("Reactions (no media)", "Total reactions (no media)", 
              "Share of women in parliament", 
              "Worse total freedom (political rights + civil liberties)", 
              "2000 TIP protocol ratification", "Big aid", 
              "Regional density of criminalization")
col.labs <- c("Model 5.1", "Model 5.2", "Model 5.3", "Model 5.4")

extra.lines <- list(c("Year fixed effects",
                      rep("Yes", 4)),
                    c("Pseudo R-squared",
                      sapply(list(model5.1, model5.2, 
                                  model5.3, model5.4), 
                             calc.pseudo.r.squared)))

stargazer(model5.1, model5.2, model5.3, model5.4,
          covariate.labels=var.labs, column.labels=col.labs,
          model.numbers=FALSE, dep.var.labels.include=FALSE,
          dep.var.caption="Criminalization",
          apply.coef=exp, type="html", p.auto=FALSE, omit="factor\\(year",
          keep.stat=c("n", "ll"), 
          notes.align="l", add.lines=extra.lines,
          notes=c("Standard errors in parentheses. All explanatory variables are lagged one period unless otherwise noted."))
```

# Replication issues

While doing this, I discovered a couple minor issues with the data and the modeling methods.

## Bleeding lags

In the original AJPS article, lagged variables were not calculated by country, so values at the boundaries between countries incorrectly bleed over into adjacent countries. For example, here's an excerpt from the US-Canadian border (note: not the *actual* international border), where the logged population for the US in 2011 gets put into Canada 1991:

    name    year    logpop    logpop_1
    US      2010    19.54998  19.54161
    US      2011    19.55720  19.54998
    Canada  1991    NA        19.55720
    Canada  1992    NA        NA

This doesn't cause any problems for the TIP report models in Table 1, since those models are limited to observations after 2000—the incorrect rows are dropped. However, the models for the correlates of shaming and time to criminalization *are* affected, since they include all post-1991 observations. Models 2.1, 2.2, 3.2, 3.5, 4.2, and 4.4 are all affected by this issue.

### Differences in lagging—models 2.1 and 2.2

```{r, results='asis', echo=FALSE}
var.labs <- c("Worse civil liberties", "US aid (logged)", "GDP (logged)", 
              "Total population (logged)", "2000 TIP protocol ratification", 
              "NGO density", "Corruption", "Rule of law", "Constant")
col.labs <- c("Model 2.1<br>(original; bleeding lags)", "Model 2.1<br>(corrected lags)", 
              "Model 2.2<br>(original; bleeding lags)", "Model 2.2<br>(corrected lags)")
stargazer(model2.1, model2.1.good, model2.2, model2.2.good, 
          apply.coef=exp, covariate.labels=var.labs, column.labels=col.labs, 
          keep.stat=c("n"), model.numbers=FALSE, dep.var.labels.include=FALSE,
          dep.var.caption="US Pressure", type="html",
          notes.align="l",
          notes=c("Logit model; odds ratios reported. Non-robust standard errors in parentheses. All explanatory variables are lagged one period."))
```

### Differences in lagging—models 3.2 and 3.5

```{r, results='asis', echo=FALSE}
var.labs <- c("In report", "Share of women in parliament", "Worse civil liberties",
              "Regional density of criminalization", "2000 TIP protocol ratification",
              "Missing information (t−2)", "Total population (logged)",
              "NGO density", "GDP per capita (logged)", "Corruption", 
              "US aid as share of GDP", "US aid as share of GDP × In report")
col.labs <- c("Model 3.2<br>(original; bleeding lags)", "Model 3.2<br>(corrected lags)", 
              "Model 3.5<br>(original; bleeding lags)", "Model 3.5<br>(corrected lags)")

ses <- list(sqrt(diag(model3.2$var)), sqrt(diag(model3.2.good$var)), 
            sqrt(diag(model3.5$var)), sqrt(diag(model3.5.good$var)))

extra.lines <- list(c("Number of countries", 
                      c(model3.2.fit["n.max"], model3.2.good.fit["n.max"]),
                      c(model3.5.fit["n.max"], model3.5.good.fit["n.max"])),
                    c("Number of criminalizations", 
                      c(model3.2.fit["events"], model3.2.good.fit["events"]),
                      c(model3.5.fit["events"], model3.5.good.fit["events"])))

stargazer(model3.2, model3.2.good, model3.5, model3.5.good, 
          apply.coef=exp, covariate.labels=var.labs, column.labels=col.labs, 
          keep.stat=c("n", "ll"), model.numbers=FALSE, dep.var.labels.include=FALSE,
          dep.var.caption="Time to Criminalization", 
          se=ses, p.auto=FALSE, type="html",
          notes.align="l", add.lines=extra.lines,
          notes=c("Robust standard errors in parentheses; values differ from published article because of differences in the robustness algorithms Stata and R use. All explanatory variables are lagged one period unless otherwise noted."))
```

### Differences in lagging—models 4.2 and 4.4

```{r, results='asis', echo=FALSE}
var.labs <- c("Tier 1", "Tier 2", "Watch list", "Tier 3", "In report", 
              "First demotion (t−3)", "First demotion (t−2)", 
              "First demotion (t−1)", "Share of women in parliament", 
              "Worse civil liberties", "Regional density of criminalization", 
              "2000 TIP protocol ratification", "Missing information", 
              "Total population (logged)", "NGO density", "US aid (logged)", 
              "GDP per capita (logged)", "Corruption")
col.labs <- c("Model 4.2<br>(original; bleeding lags)", "Model 4.2<br>(corrected lags)",
              "Model 4.4<br>(original; bleeding lags)", "Model 4.4<br>(corrected lags)")

ses <- list(sqrt(diag(model4.2$var)), sqrt(diag(model4.2.good$var)),
            sqrt(diag(model4.4$var)), sqrt(diag(model4.4.good$var)))

extra.lines <- list(c("Number of countries", 
                      c(model4.2.fit["n.max"], model4.2.good.fit["n.max"]),
                      c(model4.4.fit["n.max"], model4.4.good.fit["n.max"])),
                    c("Number of criminalizations", 
                      c(model4.2.fit["events"], model4.2.good.fit["events"]),
                      c(model4.4.fit["events"], model4.4.good.fit["events"])))

stargazer(model4.2, model4.2.good, model4.4, model4.4.good, 
          apply.coef=exp, covariate.labels=var.labs, column.labels=col.labs, 
          keep.stat=c("n", "ll"), model.numbers=FALSE, dep.var.labels.include=FALSE,
          dep.var.caption="Time to Criminalization", 
          se=ses, p.auto=FALSE, type="html",
          notes.align="l", add.lines=extra.lines,
          notes=c("Robust standard errors in parentheses; values differ from published article because of differences in the robustness algorithms Stata and R use. All explanatory variables are lagged one period unless otherwise noted."))
```

## Under-the-hood improvements

By default, Stata and most other statistical packages use the Breslow approximation for handling tied event times. This is because it is the easiest to program and because it works well on older computers. However, according to Terry Therneau,^[Personal correspondence, October 19, 2015.] one of the main inventors of Cox modeling, it is less accurate. With gains in computing power and theoretical statistical work, the Efron approximation is more accurate and more computationally efficient, so in the extensions of the models I use it instead of Breslow. Here's an example of the (fairly minor) differences in the results:

### Differences in tie algorithms—model 1.2

```{r, results='asis', echo=FALSE}
var.labs <- c("Total population (logged)", "Missing information", 
              "NGO density", "Worse civil liberties", 
              "Regional density of criminalization", 
              "2000 TIP protocol ratification")
col.labs <- c("Model 1.2<br>(original; Breslow ties)", "Model 1.2<br>(Efron ties)")

ses <- list(sqrt(diag(model1.2$var)), sqrt(diag(model1.2.good$var)))

extra.lines <- list(c("Number of countries", 
                      c(model1.2.fit["n.max"], model1.2.good.fit["n.max"])),
                    c("Number of inclusions", 
                      c(model1.2.fit["events"], model1.2.good.fit["events"])))

stargazer(model1.2, model1.2.good,
          apply.coef=exp, covariate.labels=var.labs, column.labels=col.labs, 
          keep.stat=c("n", "ll"), model.numbers=FALSE, dep.var.labels.include=FALSE,
          dep.var.caption="Time to Inclusion in Report", 
          se=ses, p.auto=FALSE, type="html",
          notes.align="l", add.lines=extra.lines,
          notes=c("Robust standard errors in parentheses; values differ from published article because of differences in the robustness algorithms Stata and R use. All explanatory variables are lagged one period unless otherwise noted."))
```

# Extension and new findings

## Extension strategy

The chapter tests the effect of several explanatory variables on the probability of criminalization, as stated by these propositions:

* Countries included in the report should criminalize faster (models 3.1–3.5 in AJPS)
* Countries with harsher tiers should criminalize faster (models 4.1–4.3 in AJPS)
* Demoted countries should criminalize faster (model 4.4 in AJPS)
* Countries with a documented reaction are more likely to be concerned and therefore more likely to criminalize trafficking in the following year (models 1 and 2 in Table A5.1 in chapter)
* Countries with more types of documented reactions in general have a greater intensity of interaction with the embassy and thus are more likely to criminalize trafficking in the following year (models 3 and 4 in Table A5.1 in chapter)

For the extension of the chapter, I test the following additional propositions:

* Countries with more TIP-specific funding from the US will criminalize faster
* Countries where the US is more diplomatically involved in anti-TIP discussions with senior officials (as measured by Wikileaks cables) will criminalize faster
* Countries where there are more human trafficking NGOs (as measured by our own database of TIP NGOs) will criminalize faster
* The relationship between inclusion in the report and time to criminalization will be stronger for less democratic countries

## Variable selection process

To test the effect of these new explanatory variables on criminalization, I had to determine the most theoretically sound set of explanatory and control variables. The models in the article and the book chapter use slight variations of combinations of controls. The chapter draft, for example, tests the effect of reactions to the TIP report on criminalization and includes these variables: 

* Percent of women in parliament
* Total freedom (the sum of Freedom House's political rights and civil liberties; higher values are worse)
* 2000 TIP protocol ratification
* Big aid (1 if aid > $100,000,000)
* Regional density of criminalization

Table 3 of the article tests the effect of scrutiny (presence of the country in the TIP report) and US aid on criminalization. It uses "Percent of women in parliament", "Regional density of criminalization" and "2000 TIP protocol ratification" just like the chapter, but it also uses some slightly different controls:

* Worse civil liberties (just Freedom House's civil liberties score)
* Missing information (lagged two periods)
* Total population (logged)
* NGO density
* GDP per capita (logged)
* Corruption
* Various measures of trafficking intensity

Table 4 tests the effect of different tier assignments and demotions on criminalization and keeps all the same control variables as Table 3. In both Tables 3 and 4, trafficking intensity is never used at the same time as the population + NGO density + GDP/capita + corruption controls. 

Thus, for the extension, I use the following combinations of controls to test the relationship between the new explanatory variables and TIP criminalization. In *every* model, I include the following:

* Percent of women in parliament
* Total freedom (the sum of Freedom House's political rights and civil liberties)
* 2000 TIP protocol ratification
* Regional density of criminalization
* Missing information (lagged two periods)

Mimicking the pattern of the AJPS articles, I also run models using measures of trafficking intensity *or* this set of general controls:

* Total population (logged)
* GDP per capita (logged)
* Corruption
* NGO density *or* number of NGOs (survey database)

In some models I also include the key explanatory variables from previous propositions, such as presence in the TIP report, tier ranking, and reactions to the report.

## Effects of new variables on being included in the TIP report

Before looking at the determinants of criminalization, it might be useulf to see if these new variables help explain the process of being included in the TIP report. According to the original article, missing information and trafficking intensity lead to inclusion in the TIP report—countries with more missing information are *less* likely to appear in the report since the State Department cannot know about the severity of trafficking, while countries with worse and more intense visible trafficking are *more* likely to be included.

The new variables add some additional nuance to the selection process, but not much. Funding from the United States (logged) appears to have a slightly negative—but statistically insignificant—effect (`r I(parens(model1.4, "log.total.funding1", "z"))`). 

More engagement from the State Department has a significant and substantive positive effect on inclusion in the report, but again, with many caveats. If we measure engagement with the proportion of *observed* TIP-related cables in the Wikileaks dump, for every percent increase in State Department back chatter on trafficking, a country is 17 times more likely to enter the report (`r I(parens(model1.5, "prop_tip_wl1", "z"))`). However, if we measure engagement with the *estimated* proportion of TIP-related cables, the effect disappears entirely (`r I(parens(model1.6, "prop_tip_estimated1", "z"))`). Additionally, models using cable data are noticeably smaller than other models, with roughly 100 observations in only 24 countries, and the number of inclusions inexplicably exceeds the number of countries—there might be too much missing data. Also, the coefficient for the estimated number of TIP cables is ridiculously huge and most likely wrong.

Replacing the NGO density variable with our own NGO measure—the number of NGOs in each country from the database of human trafficking NGOs we used for the survey—yields a significant but probably non-substantive negative effect of being included in the report. For each additional anti-TIP NGO, a country is 1% less likely to enter the report in a given year (`r I(parens(model1.7, "ht_ngos", "z"))`), which is hardly a noticeable effect. Moreover, the count of NGOs is not entirely accurate—it is based on the home location of the NGO, not the location(s) where the NGO actually works. We could use data from the survey to get information about where these NGOs work, but we would have an even smaller set of data to work with.

```{r, results='asis', echo=FALSE}
var.labs <- c("Total population (logged)", "Missing information", 
              "NGO density", "Worse civil liberties", "Worse total freedom",
              "Regional density of criminalization", 
              "2000 TIP protocol ratification", 
              "Trafficking intensity in countries of origin", 
              "Trafficking intensity in transit countries", 
              "Trafficking intensity in destination countries", 
              "Total US funding for TIP (logged)", 
              "Proportion of TIP-related cables (observed in Wikileaks)", 
              "Proportion of TIP-related cables (estimated)", 
              "Number of NGOs (survey database)")
col.labs <- c("Model 1.3<br>(from AJPS)", "Model 1.4", 
              "Model 1.5", "Model 1.6", "Model 1.7")

ses <- list(sqrt(diag(model1.3$var)), 
            sqrt(diag(model1.4$var)), sqrt(diag(model1.5$var)),
            sqrt(diag(model1.6$var)), sqrt(diag(model1.7$var)))

extra.lines <- list(c("Number of countries", 
                      c(model1.3.fit["n.max"], 
                        model1.4.fit["n.max"], model1.5.fit["n.max"]),
                      c(model1.6.fit["n.max"], model1.7.fit["n.max"])),
                    c("Number of inclusions", 
                      c(model1.3.fit["events"], 
                        model1.4.fit["events"], model1.5.fit["events"]),
                      c(model1.6.fit["events"], model1.7.fit["events"])))

stargazer(model1.3, model1.4, model1.5, model1.6, model1.7,
          apply.coef=exp, covariate.labels=var.labs, column.labels=col.labs, 
          keep.stat=c("n", "ll"), model.numbers=FALSE, dep.var.labels.include=FALSE,
          dep.var.caption="Time to Inclusion in Report", 
          se=ses, p.auto=FALSE, type="html",
          notes.align="l", add.lines=extra.lines,
          notes=c("Robust standard errors in parentheses. All explanatory variables are lagged one period unless otherwise noted."))
```

## The effect of TIP-specific funding on criminalization

TIP-specific funding generally has a positive effect on the time to criminalization, increasing the probability of criminalization by 3–4% for each increase in logged funding in a given year (Extension 1.1: `r I(parens(ext1.1, "log.total.funding1", "z"))`). This finding is not necessarily robust to other specifications of the model, though, and weakens or disappears when using our own measure of NGOs, including incidence data, or controlling for tier ratings and demotions. 

```{r, results='asis', echo=FALSE}
var.labs <- c("Total US funding for TIP (logged)", "Share of women in parliament",
              "Worse total freedom (political rights + civil liberties)",
              "2000 TIP protocol ratification", 
              "Regional density of criminalization",
              "Missing information", "Total population (logged)",
              "GDP per capita (logged)", "Corruption", 
              "NGO density", "Number of NGOs (survey database)",
              "Trafficking intensity in countries of origin", 
              "Trafficking intensity in transit countries", 
              "Trafficking intensity in destination countries")

col.labs <- c("Extension 1.0", "Extension 1.1", "Extension 1.2", "Extension 1.3")

ses <- list(sqrt(diag(ext1.1$var)), sqrt(diag(ext1.1$var)), 
            sqrt(diag(ext1.2$var)), sqrt(diag(ext1.3$var)))

extra.lines <- list(c("Number of countries", 
                      c(ext1.0.fit["n.max"], ext1.1.fit["n.max"], 
                        ext1.2.fit["n.max"], ext1.3.fit["n.max"])),
                    c("Number of inclusions", 
                      c(ext1.0.fit["events"], ext1.1.fit["events"], 
                        ext1.2.fit["events"], ext1.3.fit["events"])))

stargazer(ext1.0, ext1.1, ext1.2, ext1.3, 
          apply.coef=exp, column.labels=col.labs, covariate.labels=var.labs,
          keep.stat=c("n", "ll"), model.numbers=FALSE, dep.var.labels.include=FALSE,
          dep.var.caption="Time to Criminalization", 
          se=ses, p.auto=FALSE, type="html",
          notes.align="l", add.lines=extra.lines,
          notes=c("Robust standard errors in parentheses. All explanatory variables are lagged one period unless otherwise noted."))
```

```{r, results='asis', echo=FALSE}
var.labs <- c("Total US funding for TIP (logged)", "In report", 
              "Tier 1", "Tier 2", "Watch list", "Tier 3", 
              "First demotion (t−3)", "First demotion (t−2)", 
              "First demotion (t−1)", "Share of women in parliament",
              "Worse total freedom (political rights + civil liberties)",
              "2000 TIP protocol ratification", 
              "Regional density of criminalization",
              "Missing information")
col.labs <- c("Extension 1.4", "Extension 1.5", "Extension 1.6")

ses <- list(sqrt(diag(ext1.4$var)), sqrt(diag(ext1.5$var)), 
            sqrt(diag(ext1.6$var)))

extra.lines <- list(c("Number of countries", 
                      c(ext1.4.fit["n.max"], ext1.5.fit["n.max"], 
                        ext1.6.fit["n.max"])),
                    c("Number of inclusions", 
                      c(ext1.4.fit["events"], ext1.5.fit["events"], 
                        ext1.6.fit["events"])))

stargazer(ext1.4, ext1.5, ext1.6,
          apply.coef=exp, column.labels=col.labs, covariate.labels=var.labs, 
          keep.stat=c("n", "ll"), model.numbers=FALSE, dep.var.labels.include=FALSE,
          dep.var.caption="Time to Criminalization", 
          se=ses, p.auto=FALSE, type="html",
          notes.align="l", add.lines=extra.lines,
          notes=c("Robust standard errors in parentheses. All explanatory variables are lagged one period unless otherwise noted."))
```

## The effect of US engagement on criminalization

State Department cable discussions about host country TIP efforts have no effect on the time to criminalization, looking at both the observed (`r I(parens(ext2.0, "prop_tip_wl1", "z"))`) and the estimated (`r I(parens(ext2.00, "prop_tip_estimated1", "z"))`) number of cables.

```{r, results='asis', echo=FALSE}
var.labs <- c("Proportion of TIP-related cables (observed in Wikileaks)", 
              "Proportion of TIP-related cables (estimated)",
              "Share of women in parliament",
              "Worse total freedom (political rights + civil liberties)",
              "2000 TIP protocol ratification", 
              "Regional density of criminalization",
              "Missing information", "Total population (logged)",
              "GDP per capita (logged)", "Corruption", 
              "NGO density", "Number of NGOs (survey database)",
              "Trafficking intensity in countries of origin", 
              "Trafficking intensity in transit countries", 
              "Trafficking intensity in destination countries")
col.labs <- c("Ext. 2.0", "Ext. 2.00",
              "Ext. 2.1", "Ext. 2.2", "Ext. 2.3",
              "Ext. 2.4", "Ext. 2.5", "Ext. 2.6")

ses <- list(sqrt(diag(ext2.0$var)), sqrt(diag(ext2.00$var)),
            sqrt(diag(ext2.1$var)), sqrt(diag(ext2.2$var)), 
            sqrt(diag(ext2.3$var)), sqrt(diag(ext2.4$var)), 
            sqrt(diag(ext2.5$var)), sqrt(diag(ext2.6$var)))

extra.lines <- list(c("Number of countries", 
                      c(ext2.0.fit["n.max"], ext2.00.fit["n.max"],
                        ext2.1.fit["n.max"], ext2.2.fit["n.max"], 
                        ext2.3.fit["n.max"], ext2.4.fit["n.max"],
                        ext2.5.fit["n.max"], ext2.6.fit["n.max"])),
                    c("Number of inclusions", 
                      c(ext2.0.fit["events"], ext2.00.fit["events"],
                        ext2.1.fit["events"], ext2.2.fit["events"], 
                        ext2.3.fit["events"], ext2.4.fit["events"],
                        ext2.5.fit["events"], ext2.6.fit["events"])))

stargazer(ext2.0, ext2.00, ext2.1, ext2.2, ext2.3, ext2.4, ext2.5, ext2.6,
          apply.coef=exp, column.labels=col.labs, covariate.labels=var.labs,
          keep.stat=c("n", "ll"), model.numbers=FALSE, dep.var.labels.include=FALSE,
          dep.var.caption="Time to Criminalization", 
          se=ses, p.auto=FALSE, type="html",
          notes.align="l", add.lines=extra.lines,
          notes=c("Robust standard errors in parentheses. All explanatory variables are lagged one period unless otherwise noted."))
```

```{r, results='asis', echo=FALSE}
var.labs <- c("Proportion of TIP-related cables (observed in Wikileaks)", 
              "Proportion of TIP-related cables (estimated)", "In report", 
              "Tier 1", "Tier 2", "Watch list", "Tier 3", 
              "First demotion (t−3)", "First demotion (t−2)", 
              "First demotion (t−1)", "Share of women in parliament",
              "Worse total freedom (political rights + civil liberties)",
              "2000 TIP protocol ratification", 
              "Regional density of criminalization",
              "Missing information")
col.labs <- c("Extension 2.7", "Extension 2.8", "Extension 2.9",
              "Extension 2.10", "Extension 2.11", "Extension 2.12")

ses <- list(sqrt(diag(ext2.7$var)), sqrt(diag(ext2.8$var)), 
            sqrt(diag(ext2.9$var)), sqrt(diag(ext2.10$var)), 
            sqrt(diag(ext2.11$var)), sqrt(diag(ext2.12$var)))

extra.lines <- list(c("Number of countries", 
                      c(ext2.7.fit["n.max"], ext2.8.fit["n.max"], 
                        ext2.9.fit["n.max"], ext2.10.fit["n.max"],
                        ext2.11.fit["n.max"], ext2.12.fit["n.max"])),
                    c("Number of inclusions", 
                      c(ext2.7.fit["events"], ext2.8.fit["events"], 
                        ext2.9.fit["events"], ext2.10.fit["events"],
                        ext2.11.fit["events"], ext2.12.fit["events"])))

stargazer(ext2.7, ext2.8, ext2.9, ext2.10, ext2.11, ext2.12,
          apply.coef=exp, column.labels=col.labs, covariate.labels=var.labs, 
          keep.stat=c("n", "ll"), model.numbers=FALSE, dep.var.labels.include=FALSE,
          dep.var.caption="Time to Criminalization", 
          se=ses, p.auto=FALSE, type="html",
          notes.align="l", add.lines=extra.lines,
          notes=c("Robust standard errors in parentheses. All explanatory variables are lagged one period unless otherwise noted."))
```

## The effect of reactions + new variables on criminalization (logistic regression)

When combined with the reactions data, none of the additional variables help explain the variance in time to criminalization. US TIP funding has no effect, as expected. Observed (`r I(parens(model5.6, "prop_tip_wl1", "z"))`) and estimated (`r I(parens(model5.7, "prop_tip_estimated1", "z"))`) State Department cables on TIP-related matters have no effect, and more human trafficking NGOs in a country does little to influence the passage of criminalization legislation (`r I(parens(model5.8, "ht_ngos", "z"))`).

### Table: The effect of reactions to the TIP report *and* funding, engagement, and NGO density on criminalization

```{r, results='asis', echo=FALSE}
var.labs <- c("Total reactions (no media)", 
              "Share of women in parliament", 
              "Worse total freedom (political rights + civil liberties)", 
              "2000 TIP protocol ratification", "Big aid", 
              "Regional density of criminalization", 
              "Total US funding for TIP (logged)", 
              "Proportion of TIP-related cables (observed in Wikileaks)", 
              "Proportion of TIP-related cables (estimated)", 
              "Number of NGOs (survey database)")
col.labs <- c("Model 5.5", "Model 5.6", "Model 5.7", "Model 5.8")

extra.lines <- list(c("Year fixed effects",
                      rep("Yes", 4)),
                    c("Pseudo R-squared",
                      sapply(list(model5.5, model5.6, 
                                  model5.7, model5.8), 
                             calc.pseudo.r.squared)))

stargazer(model5.5, model5.6, model5.7, model5.8,
          covariate.labels=var.labs, column.labels=col.labs,
          model.numbers=FALSE, dep.var.labels.include=FALSE,
          dep.var.caption="Criminalization",
          apply.coef=exp, type="html", p.auto=FALSE, omit="factor\\(year",
          keep.stat=c("n", "ll"), 
          notes.align="l", add.lines=extra.lines,
          notes=c("Standard errors in parentheses. All explanatory variables are lagged one period unless otherwise noted."))
```

## ~~Effects of new variables on criminalization~~ (old, without standardized controls)

The original article showed that a number of factors increased the probability that a country criminalized human trafficking in a given year, with inclusion in the TIP report the most potent. The proportion of women in parliament, the respect of civil liberties, the presence of criminalization in neighboring countries, and other variables also had an effect on the likelihood of criminalization. 

Again, the new variables show some promise in explaining the criminalization process, but not much. US TIP funding again has some wonky math issues that I need to look into (with a hazard ratio of 1 and a standard error of 0).

While State Department chatter about TIP issues did influence the decision to include a country in the TIP report (assuming the math is right), it doesn't seem that US engagement in TIP advocacy has an effect on a country's decision to criminalize human trafficking, either measured with observed Wikileaks cables (`r I(parens(model3.7, "prop_tip_wl1", "z"))`) or estimated cables (`r I(parens(model3.8, "prop_tip_estimated1", "z"))`). 

The presence of more human trafficking NGOs does appear to influence the decision to criminalize though—for each additional NGO with headquarters in a country, the chance that that country will criminalize trafficking increases by 2% (`r I(parens(model3.9, "ht_ngos", "z"))`). 

### Table: The effect of funding, engagement, and NGO density on criminalization

```{r, results='asis', echo=FALSE}
var.labs <- c("In report", "Share of women in parliament", "Worse civil liberties",
              "Regional density of criminalization", "2000 TIP protocol ratification",
              "Missing information (t−2)", "Total population (logged)",
              "NGO density", "GDP per capita (logged)", "Corruption",
              "Total US funding for TIP (logged)", 
              "Proportion of TIP-related cables (observed in Wikileaks)", 
              "Proportion of TIP-related cables (estimated)", 
              "Number of NGOs (survey database)")
col.labs <- c("Model 3.2<br>(from AJPS)", "Model 3.6", "Model 3.7", 
              "Model 3.8", "Model 3.9")

ses <- list(sqrt(diag(model3.2$var)),
            sqrt(diag(model3.6$var)), sqrt(diag(model3.7$var)), 
            sqrt(diag(model3.8$var)), sqrt(diag(model3.9$var)))

extra.lines <- list(c("Number of countries", 
                      c(model3.2.fit["n.max"],
                        model3.6.fit["n.max"], model3.7.fit["n.max"]),
                      c(model3.8.fit["n.max"], model3.9.fit["n.max"])),
                    c("Number of criminalizations", 
                      c(model3.2.fit["events"],
                        model3.6.fit["events"], model3.7.fit["events"]),
                      c(model3.8.fit["events"], model3.9.fit["events"])))

stargazer(model3.2, model3.6, model3.7, model3.8, model3.9, 
          apply.coef=exp, covariate.labels=var.labs, column.labels=col.labs, 
          keep.stat=c("n", "ll"), model.numbers=FALSE, dep.var.labels.include=FALSE,
          dep.var.caption="Time to Criminalization", 
          se=ses, p.auto=FALSE, type="html",
          notes.align="l", add.lines=extra.lines,
          notes=c("Robust standard errors in parentheses. All explanatory variables are lagged one period unless otherwise noted."))
```

## Predicting time to ratification of 2000 TIP protocol

We can use a similar set of survival models to see which factors influence a country's decision to ratify the UN's 2000 anti-TIP protocol. As seen in extensions 4.0–4.3, worse democracies are 5–10% less likely to ratify in a given year (Extension 4.1: `r I(parens(ext4.1, "totalfreedom1", "z"))`), while countries with more corruption more than 30% less likely to do so (Extension 4.1). Having more NGOs in the country also decreases the likelihood of criminalization (by 17%; Extension 4.1: `r I(parens(ext4.1, "ngos_ave", "z"))`), but only when measured using the original variable from AJPS and not using our own database of NGOs. Human trafficking incidence generally does little to affect the decision, except for increased trafficking intensity in destination countries, which decreases the probability of ratification. Notably, peer pressure from neighboring countries has a powerful effect on the decision to ratify. The regional density of *criminalization* in neighboring countries increases the likelihood of *protocol ratification* by 3–6 times (Extension 4.0: `r I(parens(ext4.0, "corrected_regcrim1_1", "z"))`; Extension 4.1: `r I(parens(ext4.1, "corrected_regcrim1_1", "z"))`).

Scorecard diplomacy does not appear to have an effect on the decision to ratify the protocol—neither presence in the TIP report nor the assignment of any specific tier rating changes the likelihood of adopting the protocol (see Extensions 4.4–4.6). However, the initial placement on the watchlist *does* appear to have some impact, as a country is almost 70% more likely to ratify in the year following the assignment (`r I(parens(ext4.6, "new_watch1", "z"))`).

```{r, results='asis', echo=FALSE}
var.labs <- c("Share of women in parliament",
              "Worse total freedom (political rights + civil liberties)",
              "Regional density of criminalization",
              "Missing information", "Total population (logged)",
              "GDP per capita (logged)", "Corruption", 
              "NGO density", "Number of NGOs (survey database)",
              "Trafficking intensity in countries of origin", 
              "Trafficking intensity in transit countries", 
              "Trafficking intensity in destination countries")
col.labs <- c("Extension 4.0", "Extension 4.1", "Extension 4.2", "Extension 4.3")

ses <- list(sqrt(diag(ext4.1$var)), sqrt(diag(ext4.1$var)), 
            sqrt(diag(ext4.2$var)), sqrt(diag(ext4.3$var)))

extra.lines <- list(c("Number of countries", 
                      c(ext4.0.fit["n.max"], ext4.4.fit["n.max"], 
                        ext4.2.fit["n.max"], ext4.3.fit["n.max"])),
                    c("Number of inclusions", 
                      c(ext4.0.fit["events"], ext4.4.fit["events"], 
                        ext4.2.fit["events"], ext4.3.fit["events"])))

stargazer(ext4.0, ext4.1, ext4.2, ext4.3, 
          apply.coef=exp, column.labels=col.labs, covariate.labels=var.labs,
          keep.stat=c("n", "ll"), model.numbers=FALSE, dep.var.labels.include=FALSE,
          dep.var.caption="Time to Ratification", 
          se=ses, p.auto=FALSE, type="html",
          notes.align="l", add.lines=extra.lines,
          notes=c("Robust standard errors in parentheses. All explanatory variables are lagged one period unless otherwise noted."))
```

```{r, results='asis', echo=FALSE}
var.labs <- c("In report", 
              "Tier 1", "Tier 2", "Watch list", "Tier 3", 
              "First demotion (t−3)", "First demotion (t−2)", 
              "First demotion (t−1)", "Share of women in parliament",
              "Worse total freedom (political rights + civil liberties)",
              "Regional density of criminalization",
              "Missing information")
col.labs <- c("Extension 4.4", "Extension 4.5", "Extension 4.6")

ses <- list(sqrt(diag(ext4.4$var)), sqrt(diag(ext4.5$var)), 
            sqrt(diag(ext4.6$var)))

extra.lines <- list(c("Number of countries", 
                      c(ext4.4.fit["n.max"], ext4.5.fit["n.max"], 
                        ext4.6.fit["n.max"])),
                    c("Number of inclusions", 
                      c(ext4.4.fit["events"], ext4.5.fit["events"], 
                        ext4.6.fit["events"])))

stargazer(ext4.4, ext4.5, ext4.6,
          apply.coef=exp, column.labels=col.labs, covariate.labels=var.labs, 
          keep.stat=c("n", "ll"), model.numbers=FALSE, dep.var.labels.include=FALSE,
          dep.var.caption="Time to Ratification", 
          se=ses, p.auto=FALSE, type="html",
          notes.align="l", add.lines=extra.lines,
          notes=c("Robust standard errors in parentheses. All explanatory variables are lagged one period unless otherwise noted."))
```

## The relationship between media coverage of TIP issues and presence in the TIP report

```{r, results='asis', echo=FALSE}
var.labs <- c("In report (difference from previous year)",
              "In report", "Coverage (lagged)",
              "Worse civil liberties", "GDP per capita (logged)",
              "2000 TIP protocol ratification", "Population (logged)")

col.labs <- c("Media coverage 1", "Media coverage 2", "Media coverage 3")
dv.labs <- c("Change in coverage", "Coverage", "Coverage")

extra.lines <- list(c("Year fixed effects", rep("Yes", 3)),
                    c("Country fixed effects", rep("Yes", 3)))

stargazer(model.change, model.coverage, model.coverage1,
          column.labels=col.labs, covariate.labels=var.labs,
          dep.var.labels=dv.labs,
          dep.var.caption="", model.numbers=FALSE,
          type="html", omit="\\.factor",
          notes.align="l", add.lines=extra.lines,
          notes=c("All explanatory variables are lagged one period unless otherwise noted."))
```

## Updated number of human trafficking NGOs

Substituting the number of NGOs in the database used for the survey yields smaller (and seemingly more precise) effects on both the time to entering the report (explained in section 3.3 above) and the time to criminalization. In Extension 1.2, an additional NGO in a country increases the odds of criminalization in a given year by 2% (`r I(parens(ext1.2, "ht_ngos", "z"))`), which is a smaller and more precise effect than the original NGO density variable in Extension 1.1 (`r I(parens(ext1.1, "ngos_ave", "z"))`). The new measure has no effect when used as a covariate for estimating the effect of US engagement. In Extensions 2.1 and 2.2, the original NGO density variable increases the odds of criminalization by roughly 25% (Extension 2.1: `r I(parens(ext2.1, "ngos_ave", "z"))`), but that effect drops to an insignificant 2% with the updated measure (Extension 2.3: `r I(parens(ext2.3, "ht_ngos", "z"))`). It is likely, however, that the effects are generally similar, since the two measures use different scales.

## The effect of democracy on criminalization

The chapter draft currently claims that the "relationship between being included in the report and time to criminalization depends on the level of democracy" and that "the models reinforce that the relationship between inclusion in the report and time to criminalization appears to be stronger for less democratic countries." This conclusion is generally borne out in the updated results when using Freedom House's measure of political rights and civil liberties as a stand-in for democracy.

Countries with worse freedom are around 10% more likely to enter the TIP report (Model 1.3: `r I(parens(model1.3, "fh_cl1", "z"))`), and in every model of criminalization, countries with worse freedom are 2–10% less likely to criminalize in a given year (Model 2.0: `r I(parens(ext2.0, "totalfreedom1", "z"))`). 

## Extension conclusions

*Proposition: Countries with more TIP-specific funding from the US will criminalize faster.*

There is generally a weak relationship between US funding and time to criminalization.

*Proposition: Countries where the US is more diplomatically involved in anti-TIP discussions with senior officials (as measured by Wikileaks cables) will criminalize faster.*

There is no relationship between diplomatic involvement and time to criminalization.

*Proposition: Countries where there are more human trafficking NGOs will criminalize faster.*

More NGOs in a country leads to minor, insubstantial, and generally insignificant increases in the odds of criminalization.

*Proposition: The relationship between inclusion in the report and time to criminalization will be stronger for less democratic countries.*

Countries with worse civil rights and political liberties are more likely to enter the TIP report and less likely to criminalize trafficking. 

---

***NOTE***: Far more detailed analysis of interactive effects can be seen [here](interactions.html).

---

---

# Final tables to be included in the chapter or appendix

Which tables go here?

---

# To do

* Figure out what's going on with semi-useless cable variables?
* Improve, standardize graphics
